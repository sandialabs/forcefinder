
<!DOCTYPE html>


<html lang="en" data-content_root="../../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>forcefinder.core.auto_regularization &#8212; ForceFinder Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'autoapi/forcefinder/core/auto_regularization/index';</script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="forcefinder.core.inverse_processing" href="../inverse_processing/index.html" />
    <link rel="prev" title="forcefinder.core" href="../index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../../theory_api_documentation_intro.html">
  
  
  
  
  
  
    <p class="title logo__title">ForceFinder Documentation</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../../theory_api_documentation_intro.html">
                    ForceFinder Theory and Programming Interface Documentation
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../forcefinder_framework.html">ForceFinder Framework</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../spr_types.html">SourcePathReceiver Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../automatic_bookkeeping.html">Automatic Bookkeeping, Sample Splitting, and Inverse Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../inverse_method_code.html">Anatomy of an Inverse Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../object_attribute_definitions.html">SourcePathReceiver Object Attributes</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../method_theory_intro.html">Theory Guide</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../inverse_problem_form.html">Inverse Problem Form</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../regularization_methods.html">Regularization Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../hyperparameter_tuning_methods.html">Hyperparameter Tuning Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../transformation_theory.html">Transformation Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../miscellaneous_techniques.html">Theory for Miscellaneous Techniques</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../error_metrics.html">Error Metrics</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../example_utilization_intro.html">Example Utilization</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../basic_spr_utilization.html">Basic Use of the SourcePathReceiver Object</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../spr_utilization_transformations.html">Source Estimation with the Virtual Point Transformation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../spr_utilization_response_limit.html">MIMO Drive Prediction with Response Limiting</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../../../index.html">API Reference</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active has-children"><a class="reference internal" href="../../index.html">forcefinder</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 current active has-children"><a class="reference internal" href="../index.html">forcefinder.core</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l4 current active"><a class="current reference internal" href="#">forcefinder.core.auto_regularization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../inverse_processing/index.html">forcefinder.core.inverse_processing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../response_limit/index.html">forcefinder.core.response_limit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../source_path_receiver/index.html">forcefinder.core.source_path_receiver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sparse_functions/index.html">forcefinder.core.sparse_functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../transient_utilities/index.html">forcefinder.core.transient_utilities</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utilities/index.html">forcefinder.core.utilities</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../rattlesnake_control_laws/index.html">forcefinder.rattlesnake_control_laws</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../rattlesnake_control_laws/spr_random_control_law/index.html">forcefinder.rattlesnake_control_laws.spr_random_control_law</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../transient_quality_evaluation/index.html">forcefinder.transient_quality_evaluation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../transient_quality_evaluation/transient_gui_plot/index.html">forcefinder.transient_quality_evaluation.transient_gui_plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../transient_quality_evaluation/transient_quality_metrics/index.html">forcefinder.transient_quality_evaluation.transient_quality_metrics</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../../_sources/autoapi/forcefinder/core/auto_regularization/index.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>forcefinder.core.auto_regularization</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#functions">Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-contents">Module Contents</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forcefinder.core.auto_regularization.tikhonov_full_path_for_l_curve"><code class="docutils literal notranslate"><span class="pre">tikhonov_full_path_for_l_curve()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forcefinder.core.auto_regularization.compute_regularized_residual_penalty_for_l_curve"><code class="docutils literal notranslate"><span class="pre">compute_regularized_residual_penalty_for_l_curve()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forcefinder.core.auto_regularization.compute_regularized_svd_inv"><code class="docutils literal notranslate"><span class="pre">compute_regularized_svd_inv()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forcefinder.core.auto_regularization.mean_squared_error"><code class="docutils literal notranslate"><span class="pre">mean_squared_error()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forcefinder.core.auto_regularization.leave_one_out_cv"><code class="docutils literal notranslate"><span class="pre">leave_one_out_cv()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forcefinder.core.auto_regularization.k_fold_cv"><code class="docutils literal notranslate"><span class="pre">k_fold_cv()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forcefinder.core.auto_regularization.l_curve_optimal_regularization"><code class="docutils literal notranslate"><span class="pre">l_curve_optimal_regularization()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forcefinder.core.auto_regularization.broadcasting_l_curve_criterion"><code class="docutils literal notranslate"><span class="pre">broadcasting_l_curve_criterion()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forcefinder.core.auto_regularization.broadcasting_l_curve_by_distance"><code class="docutils literal notranslate"><span class="pre">broadcasting_l_curve_by_distance()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forcefinder.core.auto_regularization.select_model_by_information_criterion"><code class="docutils literal notranslate"><span class="pre">select_model_by_information_criterion()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forcefinder.core.auto_regularization.compute_tikhonov_regularized_frf_pinv"><code class="docutils literal notranslate"><span class="pre">compute_tikhonov_regularized_frf_pinv()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forcefinder.core.auto_regularization.compute_regularized_forces"><code class="docutils literal notranslate"><span class="pre">compute_regularized_forces()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forcefinder.core.auto_regularization.l_curve_selection"><code class="docutils literal notranslate"><span class="pre">l_curve_selection()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forcefinder.core.auto_regularization.l_curve_criterion"><code class="docutils literal notranslate"><span class="pre">l_curve_criterion()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forcefinder.core.auto_regularization.optimal_l_curve_by_distance"><code class="docutils literal notranslate"><span class="pre">optimal_l_curve_by_distance()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forcefinder.core.auto_regularization.compute_residual_penalty_for_l_curve"><code class="docutils literal notranslate"><span class="pre">compute_residual_penalty_for_l_curve()</span></code></a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="module-forcefinder.core.auto_regularization">
<span id="forcefinder-core-auto-regularization"></span><h1>forcefinder.core.auto_regularization<a class="headerlink" href="#module-forcefinder.core.auto_regularization" title="Link to this heading">#</a></h1>
<p>Contains helper functions for performing automatic regularization with
the truncated singular value decomposition, ridge regression (Tikhonov),
and the elastic net. These functions are intended to work with data from
a SourcePathReceiver object.</p>
<p>Copyright 2025 National Technology &amp; Engineering Solutions of Sandia,
LLC (NTESS). Under the terms of Contract DE-NA0003525 with NTESS, the U.S.
Government retains certain rights in this software.</p>
<p>This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.</p>
<p>This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License
along with this program.  If not, see &lt;<a class="reference external" href="https://www.gnu.org/licenses/">https://www.gnu.org/licenses/</a>&gt;.</p>
<section id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#forcefinder.core.auto_regularization.tikhonov_full_path_for_l_curve" title="forcefinder.core.auto_regularization.tikhonov_full_path_for_l_curve"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tikhonov_full_path_for_l_curve</span></code></a>(frfs, response[, ...])</p></td>
<td><p>Performs the inverse force estimation problem and computes the necessary residual and</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#forcefinder.core.auto_regularization.compute_regularized_residual_penalty_for_l_curve" title="forcefinder.core.auto_regularization.compute_regularized_residual_penalty_for_l_curve"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_regularized_residual_penalty_for_l_curve</span></code></a>(frfs, ...)</p></td>
<td><p>Computes the residual and penalty from the regularized SVD components of an FRF</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#forcefinder.core.auto_regularization.compute_regularized_svd_inv" title="forcefinder.core.auto_regularization.compute_regularized_svd_inv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_regularized_svd_inv</span></code></a>(frfs[, ...])</p></td>
<td><p>Computes the inverted regularized SVD components for an automatic Tikhonov</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#forcefinder.core.auto_regularization.mean_squared_error" title="forcefinder.core.auto_regularization.mean_squared_error"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mean_squared_error</span></code></a>(validation_frfs, ...)</p></td>
<td><p>Computes the mean squared error of the validation response(s) from the</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#forcefinder.core.auto_regularization.leave_one_out_cv" title="forcefinder.core.auto_regularization.leave_one_out_cv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">leave_one_out_cv</span></code></a>(frfs, response[, ...])</p></td>
<td><p>Estimates the error in a force estimation problem with leave one out cross</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#forcefinder.core.auto_regularization.k_fold_cv" title="forcefinder.core.auto_regularization.k_fold_cv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">k_fold_cv</span></code></a>(frfs, response[, number_folds, random_seed, ...])</p></td>
<td><p>Estimates the error in a force estimation problem with K-fold cross</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#forcefinder.core.auto_regularization.l_curve_optimal_regularization" title="forcefinder.core.auto_regularization.l_curve_optimal_regularization"><code class="xref py py-obj docutils literal notranslate"><span class="pre">l_curve_optimal_regularization</span></code></a>(regularization_values, ...)</p></td>
<td><p>Selects the optimal regularization parameter using L-curve methods.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#forcefinder.core.auto_regularization.broadcasting_l_curve_criterion" title="forcefinder.core.auto_regularization.broadcasting_l_curve_criterion"><code class="xref py py-obj docutils literal notranslate"><span class="pre">broadcasting_l_curve_criterion</span></code></a>(x_axis, y_axis, ...[, ...])</p></td>
<td><p>Finds the &quot;optimal&quot; regularization value from an L-curve via the</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#forcefinder.core.auto_regularization.broadcasting_l_curve_by_distance" title="forcefinder.core.auto_regularization.broadcasting_l_curve_by_distance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">broadcasting_l_curve_by_distance</span></code></a>(x_axis, y_axis, ...)</p></td>
<td><p>Finds the &quot;optimal&quot; regularization from an L-curve by finding the parameter</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#forcefinder.core.auto_regularization.select_model_by_information_criterion" title="forcefinder.core.auto_regularization.select_model_by_information_criterion"><code class="xref py py-obj docutils literal notranslate"><span class="pre">select_model_by_information_criterion</span></code></a>(H, x, f, method)</p></td>
<td><p>Performs model selection with the desired information criterion.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#forcefinder.core.auto_regularization.compute_tikhonov_regularized_frf_pinv" title="forcefinder.core.auto_regularization.compute_tikhonov_regularized_frf_pinv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_tikhonov_regularized_frf_pinv</span></code></a>(frfs[, ...])</p></td>
<td><p>Computes the Tikhonov regularized FRF pseudo-inverse for many regularization parameters.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#forcefinder.core.auto_regularization.compute_regularized_forces" title="forcefinder.core.auto_regularization.compute_regularized_forces"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_regularized_forces</span></code></a>(regularized_frf_inverse, ...)</p></td>
<td><p>Computes the forces from a regularized inverse of an FRF matrix.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#forcefinder.core.auto_regularization.l_curve_selection" title="forcefinder.core.auto_regularization.l_curve_selection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">l_curve_selection</span></code></a>(regularization_values, penalty, ...)</p></td>
<td><p>Selects the optimal regularization parameter and forces using L-curve methods</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#forcefinder.core.auto_regularization.l_curve_criterion" title="forcefinder.core.auto_regularization.l_curve_criterion"><code class="xref py py-obj docutils literal notranslate"><span class="pre">l_curve_criterion</span></code></a>(x_axis, y_axis, regularization_values)</p></td>
<td><p>Finds the &quot;optimal&quot; regularization value from an L-curve via the</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#forcefinder.core.auto_regularization.optimal_l_curve_by_distance" title="forcefinder.core.auto_regularization.optimal_l_curve_by_distance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optimal_l_curve_by_distance</span></code></a>(x_axis, y_axis, ...)</p></td>
<td><p>Finds the &quot;optimal&quot; regularization from an L-curve by finding the parameter</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#forcefinder.core.auto_regularization.compute_residual_penalty_for_l_curve" title="forcefinder.core.auto_regularization.compute_residual_penalty_for_l_curve"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_residual_penalty_for_l_curve</span></code></a>(frfs, forces, ...)</p></td>
<td><p>Computes the residual and penalty for an inverse force estimation problem</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="forcefinder.core.auto_regularization.tikhonov_full_path_for_l_curve">
<span class="sig-name descname"><span class="pre">tikhonov_full_path_for_l_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frfs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">response</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low_regularization_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high_regularization_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_regularization_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/forcefinder/core/auto_regularization.html#tikhonov_full_path_for_l_curve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#forcefinder.core.auto_regularization.tikhonov_full_path_for_l_curve" title="Link to this definition">#</a></dt>
<dd><p>Performs the inverse force estimation problem and computes the necessary residual and
penalty for model selection with the L-curve criterion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frfs</strong> (<em>ndarray</em>) – The array of FRFs for the inverse force estimation problem, should be organized
[number of lines, number of responses, number of references].</p></li>
<li><p><strong>response</strong> (<em>ndarray</em>) – The response to compute the forces from. Should be sized [number of lines, number of responses]
for linear spectra or [number of lines, number of responses, number of responses] for power spectra.</p></li>
<li><p><strong>low_regularization_limit</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – The low regularization limit to search through. This should be a 1d
array with a length that matches the number of frequency lines in
the SourcePathReceiver object. The default is the smallest singular
value of the frf array (on a frequency-frequency basis).</p></li>
<li><p><strong>high_regularization_limit</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – The high regularization limit to search through. This should be a 1d
array with a length that matches the number of frequency lines in
the SourcePathReceiver object. The default is the largest singular
value of the frf array (on a frequency-frequency basis).</p></li>
<li><p><strong>number_regularization_values</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of regularization parameters to search over, where the
potential parameters are geometrically spaced between the low and high
regularization limits. The default is 100.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>regularization_values</strong> (<em>ndarray</em>) – The regularization parameters that were used in the inverse. It is sized
[number of parameters, number of lines].</p></li>
<li><p><strong>residual</strong> (<em>ndarray</em>) – The residual error (i.e., sum squared error) between the computed and truth response.
It is sized [number of parameters, number of lines].</p></li>
<li><p><strong>penalty</strong> (<em>ndarray</em>) – The penalty to use in the L-curve parameter selection, which is the squared sum
of the forces. It is sized [number of parameters, number of lines].</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The regularization values are spread over a geometric sequence that spans
the low and high regularization limits.</p>
<p>The high and low regularization parameter limits cannot be set to zero in this function.
Any values that are zero are reset to machine epsilon.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="forcefinder.core.auto_regularization.compute_regularized_residual_penalty_for_l_curve">
<span class="sig-name descname"><span class="pre">compute_regularized_residual_penalty_for_l_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frfs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">response</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Uh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regularized_S</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/forcefinder/core/auto_regularization.html#compute_regularized_residual_penalty_for_l_curve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#forcefinder.core.auto_regularization.compute_regularized_residual_penalty_for_l_curve" title="Link to this definition">#</a></dt>
<dd><p>Computes the residual and penalty from the regularized SVD components of an FRF
for an automatic Tikhonov regularization problem.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frfs</strong> (<em>ndarray</em>) – The array of FRFs for the inverse force estimation problem, should be organized
[number of lines, number of responses, number of references].</p></li>
<li><p><strong>response</strong> (<em>ndarray</em>) – The response to compute the forces from. Should be sized [number of lines, number of responses]
for linear spectra or [number of lines, number of responses, number of responses] for power spectra.</p></li>
<li><p><strong>Uh</strong> (<em>ndarray</em>) – The conjugate-transpose of the left singular vectors of the supplied FRFs.
It is shaped [number of lines, number of responses, number of references].</p></li>
<li><p><strong>V</strong> (<em>ndarray</em>) – The right singular vectors of the supplied FRFs. It is shaped
[number of lines, number of references, number of references].</p></li>
<li><p><strong>regularized_S</strong> (<em>ndarray</em>) – The inverted and Tikhonov regularized singular values of the supplied
FRFs. It is shaped [number of values, number of lines, number of references].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>regularization_values</strong> (<em>ndarray</em>) – The regularization parameters that were used in the inverse. It is sized
[number of parameters, number of lines].</p></li>
<li><p><strong>residual</strong> (<em>ndarray</em>) – The residual error (i.e., sum squared error) between the computed and truth response.
It is sized [number of parameters, number of lines].</p></li>
<li><p><strong>penalty</strong> (<em>ndarray</em>) – The penalty to use in the L-curve parameter selection, which is the squared sum
of the forces. It is sized [number of parameters, number of lines].</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="forcefinder.core.auto_regularization.compute_regularized_svd_inv">
<span class="sig-name descname"><span class="pre">compute_regularized_svd_inv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frfs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low_regularization_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high_regularization_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_regularization_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/forcefinder/core/auto_regularization.html#compute_regularized_svd_inv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#forcefinder.core.auto_regularization.compute_regularized_svd_inv" title="Link to this definition">#</a></dt>
<dd><p>Computes the inverted regularized SVD components for an automatic Tikhonov
regularization problem.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frfs</strong> (<em>ndarray</em>) – The array of FRFs for the inverse force estimation problem, should be organized
[number of lines, number of responses, number of references].</p></li>
<li><p><strong>low_regularization_limit</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – The low regularization limit to search through. This should be a 1d
array with a length that matches the number of frequency lines in
the SourcePathReceiver object. The default is the smallest singular
value of the frf array (on a frequency-frequency basis).</p></li>
<li><p><strong>high_regularization_limit</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – The high regularization limit to search through. This should be a 1d
array with a length that matches the number of frequency lines in
the SourcePathReceiver object. The default is the largest singular
value of the frf array (on a frequency-frequency basis).</p></li>
<li><p><strong>number_regularization_values</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of regularization parameters to search over, where the
potential parameters are geometrically spaced between the low and high
regularization limits. The default is 100.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>regularization_values</strong> (<em>ndarray</em>) – The regularization parameters that were used in the inverse. It is sized
[number of parameters, number of lines].</p></li>
<li><p><strong>Uh</strong> (<em>ndarray</em>) – The conjugate-transpose of the left singular vectors of the supplied FRFs.
It is shaped [number of lines, number of responses, number of references].</p></li>
<li><p><strong>V</strong> (<em>ndarray</em>) – The right singular vectors of the supplied FRFs. It is shaped
[number of lines, number of references, number of references].</p></li>
<li><p><strong>regularized_S</strong> (<em>ndarray</em>) – The inverted and Tikhonov regularized singular values of the supplied
FRFs. It is shaped [number of values, number of lines, number of references].</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The regularization values are spread over a geometric sequence that spans
the low and high regularization limits.</p>
<p>The high and low regularization parameter limits cannot be set to zero in this function.
Any values that are zero are reset to machine epsilon.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="forcefinder.core.auto_regularization.mean_squared_error">
<span class="sig-name descname"><span class="pre">mean_squared_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">validation_frfs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_response</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frf_inverse</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_response</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/forcefinder/core/auto_regularization.html#mean_squared_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#forcefinder.core.auto_regularization.mean_squared_error" title="Link to this definition">#</a></dt>
<dd><p>Computes the mean squared error of the validation response(s) from the
inverse problem.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>validation_frfs</strong> (<em>ndarray</em>) – The FRFs that are used to compute the predicted response(s) from the
predicted forces. Should be sized [number of lines, number of validation responses, number of references].</p></li>
<li><p><strong>validation_response</strong> (<em>ndarray</em>) – The validation response to compare the predicted response against.
Should be sized [number of lines, number of validation responses].</p></li>
<li><p><strong>frf_inverse</strong> (<em>ndarray</em>) – The inverted FRFs that are used to compute the predicted forces.
Should be sized [number of lines, number of references, number of training responses].</p></li>
<li><p><strong>training_response</strong> (<em>ndarray</em>) – The training responses that are used to compute the predicted forces.
Should be sized [number of lines, number of training responses].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>mean_squared_error</strong> – The mean squared error of the predicted response. It is a 1D array that
is sized the number of lines.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function assumes that there are at least two DOFs in the training response.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="forcefinder.core.auto_regularization.leave_one_out_cv">
<span class="sig-name descname"><span class="pre">leave_one_out_cv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frfs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">response</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low_regularization_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high_regularization_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_regularization_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">mean_squared_error</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/forcefinder/core/auto_regularization.html#leave_one_out_cv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#forcefinder.core.auto_regularization.leave_one_out_cv" title="Link to this definition">#</a></dt>
<dd><p>Estimates the error in a force estimation problem with leave one out cross
validation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frfs</strong> (<em>ndarray</em>) – The full FRF array to use in the inverse problem. It should be sized
[number of lines, number of responses, number of references].</p></li>
<li><p><strong>response</strong> (<em>ndarray</em>) – The full response array to use in the inverse problem. It should be
sized [number of lines, number of responses].</p></li>
<li><p><strong>low_regularization_limit</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – The low regularization limit to search through. This should be a 1d
array with a length that matches the number of frequency lines in
the SourcePathReceiver object. The default is the smallest singular
value of the frf array (on a frequency-frequency basis).</p></li>
<li><p><strong>high_regularization_limit</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – The high regularization limit to search through. This should be a 1d
array with a length that matches the number of frequency lines in
the SourcePathReceiver object. The default is the largest singular
value of the frf array (on a frequency-frequency basis).</p></li>
<li><p><strong>number_regularization_values</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of regularization parameters to search over, where the
potential parameters are geometrically spaced between the low and high
regularization limits. The default is 100.</p></li>
<li><p><strong>error_function</strong> (<em>function</em><em>, </em><em>optional</em>) – <p>The function that is used to compute the error in the inverse
problem. The function should take the following parameters:</p>
<blockquote>
<div><ul>
<li><p>validation_frfs - ndarray that is sized [number of lines, number of validation responses, number of references].</p></li>
<li><p>validation_response - ndarray that is sized [number of lines, number of responses].</p></li>
<li><p>frf_inverse - ndarray that is sized [number of lines, number of references, number of training responses].</p></li>
<li><p>training_response - ndarray that is sized [number of lines, number of training responses, 1].</p></li>
</ul>
</div></blockquote>
<dl class="simple">
<dt>The function should output:</dt><dd><ul>
<li><p>error - a 1d array that is sized number of lines.</p></li>
</ul>
</dd>
</dl>
<p>The default function computes the residual squared error.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>regularization_values</strong> (<em>ndarray</em>) – The regularization values for the inverse problem. It is sized
[number_regularization_values, number of lines].</p></li>
<li><p><strong>error</strong> (<em>ndarray</em>) – The prediction error from the inverse problem. It is sized
[number_regularization_values, number of responses, number of lines].</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="forcefinder.core.auto_regularization.k_fold_cv">
<span class="sig-name descname"><span class="pre">k_fold_cv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frfs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">response</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_folds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">randbits(128)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low_regularization_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high_regularization_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_regularization_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">mean_squared_error</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/forcefinder/core/auto_regularization.html#k_fold_cv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#forcefinder.core.auto_regularization.k_fold_cv" title="Link to this definition">#</a></dt>
<dd><p>Estimates the error in a force estimation problem with K-fold cross
validation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frfs</strong> (<em>ndarray</em>) – The full FRF array to use in the inverse problem. It should be sized
[number of lines, number of responses, number of references].</p></li>
<li><p><strong>response</strong> (<em>ndarray</em>) – The full response array to use in the inverse problem. It should be
sized [number of lines, number of responses].</p></li>
<li><p><strong>number_folds</strong> (<em>int</em>) – The number of folds to use in the cross validation. The number of
response DOFs must be evenly divisible by the number of folds.</p></li>
<li><p><strong>random_seed</strong> (<em>int</em>) – The seed for the random number generator that selects response DOFs
that are used in the different folds of the cross validation. The
default is a randomly selected integer.</p></li>
<li><p><strong>low_regularization_limit</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – The low regularization limit to search through. This should be a 1d
array with a length that matches the number of frequency lines in
the SourcePathReceiver object. The default is the smallest singular
value of the frf array (on a frequency-frequency basis).</p></li>
<li><p><strong>high_regularization_limit</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – The high regularization limit to search through. This should be a 1d
array with a length that matches the number of frequency lines in
the SourcePathReceiver object. The default is the largest singular
value of the frf array (on a frequency-frequency basis).</p></li>
<li><p><strong>number_regularization_values</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of regularization parameters to search over, where the
potential parameters are geometrically spaced between the low and high
regularization limits. The default is 100.</p></li>
<li><p><strong>error_function</strong> (<em>function</em><em>, </em><em>optional</em>) – <p>The function that is used to compute the error in the inverse
problem. The function should take the following parameters:</p>
<blockquote>
<div><ul>
<li><p>validation_frfs - ndarray that is sized [number of lines, number of validation responses, number of references].</p></li>
<li><p>validation_response - ndarray that is sized [number of lines, number of responses].</p></li>
<li><p>frf_inverse - ndarray that is sized [number of lines, number of references, number of training responses].</p></li>
<li><p>training_response - ndarray that is sized [number of lines, number of training responses, 1].</p></li>
</ul>
</div></blockquote>
<p>The function should return a 1d array that is sized number of lines.
The default function computes the mean squared error.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>regularization_values</strong> (<em>ndarray</em>) – The regularization values for the inverse problem. It is sized
[number_regularization_values, number of lines].</p></li>
<li><p><strong>error</strong> (<em>ndarray</em>) – The prediction error from the inverse problem. It is sized
[number_regularization_values, number of folds, number of lines].</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If the number of response DOFs is not evenly divisible by the number
of folds.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The response DOFs for the cross validation folds are selected by a
random number generator. This can lead to different results for multiple
function runs, since the default behavior is to use a different random
number generator every time the function is ran. A random seed can be
supplied to avoid the variability in the response DOF selection.
However, different computers may still select different response DOFs
for the different folds (even with the same seed), for a variety of
reasons.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="forcefinder.core.auto_regularization.l_curve_optimal_regularization">
<span class="sig-name descname"><span class="pre">l_curve_optimal_regularization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">regularization_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">penalty</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residual</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_curve_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'forces'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimality_condition</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'curvature'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/forcefinder/core/auto_regularization.html#l_curve_optimal_regularization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#forcefinder.core.auto_regularization.l_curve_optimal_regularization" title="Link to this definition">#</a></dt>
<dd><p>Selects the optimal regularization parameter using L-curve methods.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>regularization_values</strong> (<em>ndarray</em>) – The regularization values that were searched over. This should be sized
[number of regularization values, number of frequency lines].</p></li>
<li><p><strong>penalty</strong> (<em>ndarray</em>) – The penalty from the regularized least squares problem. This should be sized
[number of regularization values, number of frequency lines].</p></li>
<li><p><strong>residual</strong> (<em>ndarray</em>) – The residual from the regularized least squares problem (typically the
mean squared error). This should be sized
[number of regularization values, number of frequency lines].</p></li>
<li><p><strong>l_curve_type</strong> (<em>str</em>) – <p>The type of L-curve that is used to find the “optimal regularization
parameter. The available types are:</p>
<blockquote>
<div><ul>
<li><p>forces (default) - This L-curve is constructed with the “size”</p></li>
</ul>
<p>of the forces on the Y-axis and the regularization parameter on the
X-axis.</p>
<ul>
<li><p>standard - This L-curve is constructed with the residual squared</p></li>
</ul>
<p>error on the X-axis and the “size” of the forces on the Y-axis.</p>
</div></blockquote>
</p></li>
<li><p><strong>optimality_condition</strong> (<em>str</em>) – <p>The method that is used to find an “optimal” regularization parameter.
The options are:</p>
<blockquote>
<div><ul>
<li><p>curvature (default) - This method searches for the regularization</p></li>
</ul>
<p>parameter that results in maximum curvature of the L-curve. It is
also referred to as the L-curve criterion.</p>
<ul>
<li><p>distance - This method searches for the regularization parameter that</p></li>
</ul>
<p>minimizes the distance between the L-curve and a “virtual origin”. A
virtual origin is used, because the L-curve is scaled and offset to always
range from zero to one, in this case.</p>
</div></blockquote>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>optimal_regularization</strong> – A vector of the optimal regularization values, as defined by the L-curve.
The length matches that number of frequency lines.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If the requested L-curve type is not available.</p></li>
<li><p><strong>ValueError</strong> – If the requested optimality condition is not available.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">References</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id1" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>P.C. Hansen and D.P. O’Leary, “The Use of the L-Curve in the Regularization
of Discrete Ill-Posed Problems,” SIAM Journal on Scientific Computing,
vol. 14, no. 6, pp. 1487-1503, 1993.</p>
</aside>
<aside class="footnote brackets" id="id2" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<p>P.C. Hansen, “The L-curve and its use in the numerical treatment of inverse
problems,” in Computational Inverse Problems in Electrocardiology,” WIT Press,
2000, pp. 119-142.</p>
</aside>
<aside class="footnote brackets" id="id3" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></span>
<p>M. Rezghi and S. Hosseini, “A new variant of L-curve for Tikhonov regularization,”
Journal of Computational and Applied Mathematics, vol. 231, pp. 914-924, 2008.</p>
</aside>
</aside>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="forcefinder.core.auto_regularization.broadcasting_l_curve_criterion">
<span class="sig-name descname"><span class="pre">broadcasting_l_curve_criterion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regularization_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_curvature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/forcefinder/core/auto_regularization.html#broadcasting_l_curve_criterion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#forcefinder.core.auto_regularization.broadcasting_l_curve_criterion" title="Link to this definition">#</a></dt>
<dd><p>Finds the “optimal” regularization value from an L-curve via the
location where its curvature is at a maximum (the L-curve criterion).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_axis</strong> (<em>ndarray</em>) – This is a vector that defines the X-axis of the L-curve. The variable
that is used for this depends on the type of L-curve that is being
used. This should be sized [number of regularization values, number of frequency lines].</p></li>
<li><p><strong>y_axis</strong> (<em>ndarray</em>) – This is a vector that defines the Y-axis of the L-curve. The variable
that is used for this depends on the type of L-curve that is being
used. This should be sized [number of regularization values, number of frequency lines].</p></li>
<li><p><strong>regularization_values</strong> (<em>ndarray</em>) – This is a vector of regularization values that were used in the linear
regression problem that created the L-curve. This should be sized
[number of regularization values, number of frequency lines].</p></li>
<li><p><strong>return_curvature</strong> (<em>bool</em>) – Whether or not to return the computed curvature function. The default is
False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>optimal_regularization</strong> (<em>ndarray</em>) – This is the optimal regularization value based on the L-curve
criterion. It is sized [number of frequency lines]</p></li>
<li><p><strong>idx</strong> (<em>ndarray</em>) – The index that correspond to the optimal curvature. It is sized
[number of frequency lines]</p></li>
<li><p><strong>curvature</strong> (<em>ndarray, optional</em>) – A vector of the curvature of the L-curve for the give sequence
of regularization_values. This is not returned by default. It is
sized [number of regularization values, number of frequency lines].</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The code will automatically skip frequency lines where the regularization parameter
doesn’t change (e.g., 0 Hz).</p>
<p class="rubric">References</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id4" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>P.C. Hansen and D.P. O’Leary, “The Use of the L-Curve in the Regularization
of Discrete Ill-Posed Problems,” SIAM Journal on Scientific Computing,
vol. 14, no. 6, pp. 1487-1503, 1993.</p>
</aside>
<aside class="footnote brackets" id="id5" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<p>P.C. Hansen, “The L-curve and its use in the numerical treatment of inverse
problems,” in Computational Inverse Problems in Electrocardiology,” WIT Press,
2000, pp. 119-142.</p>
</aside>
</aside>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="forcefinder.core.auto_regularization.broadcasting_l_curve_by_distance">
<span class="sig-name descname"><span class="pre">broadcasting_l_curve_by_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regularization_values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/forcefinder/core/auto_regularization.html#broadcasting_l_curve_by_distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#forcefinder.core.auto_regularization.broadcasting_l_curve_by_distance" title="Link to this definition">#</a></dt>
<dd><p>Finds the “optimal” regularization from an L-curve by finding the parameter
that puts the curve closest to the “virtual origin”.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_axis</strong> (<em>ndarray</em>) – This is a vector that defines the X-axis of the L-curve. The variable
that is used for this depends on the L-curve type this should be sized
[number of regularization values, number of frequency lines].</p></li>
<li><p><strong>y_axis</strong> (<em>ndarray</em>) – This is a vector that defines the Y-axis of the L-curve. The variable
that is used for this depends on the L-curve type this should be sized
[number of regularization values, number of frequency lines].</p></li>
<li><p><strong>regularization_values</strong> (<em>ndarray</em>) – This is a vector of regularization values that were used in the linear
regression problem that created the L-curve. This should be sized
[number of regularization values, number of frequency lines].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>optimal_regularization</strong> (<em>float</em>) – This is the optimal regularization value based on the L-curve distance
from the origin.</p></li>
<li><p><strong>idx</strong> (<em>int</em>) – The index that correspond to the optimal curvature.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This technique applies a scale and offset to the L-curve so the X and Y-axis
always ranges from zero to one. This is required to obtain predictable
behavior from the method, but can also distort the shape of the curve.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="forcefinder.core.auto_regularization.select_model_by_information_criterion">
<span class="sig-name descname"><span class="pre">select_model_by_information_criterion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/forcefinder/core/auto_regularization.html#select_model_by_information_criterion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#forcefinder.core.auto_regularization.select_model_by_information_criterion" title="Link to this definition">#</a></dt>
<dd><p>Performs model selection with the desired information criterion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>H</strong> (<em>ndarray</em>) – The FRFs that were used to estimate the forces, sized:
[number_lines, number_responses, number_references].</p></li>
<li><p><strong>x</strong> (<em>ndarray</em>) – The responses that were used in the force estimation, sized:
[number_lines, number_responses].</p></li>
<li><p><strong>f</strong> (<em>ndarray</em>) – The estimated forces from the model, sized:
[number_lines, number_models, number_references]</p></li>
<li><p><strong>method</strong> (<em>str</em>) – <p>The desired information criterion, the available options are:</p>
<blockquote>
<div><ul>
<li><p>’BIC’: the Bayesian information criterion</p></li>
<li><p>’AIC’: the Akaike information criterion</p></li>
<li><p>’AICC’: the corrected Akaike information criterion</p></li>
</ul>
</div></blockquote>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>selected_forces</strong> – The forces that were selected using the desired model, sized:
[number_lines, number_references]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – If the supplied responses are a CPSD matrix.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="forcefinder.core.auto_regularization.compute_tikhonov_regularized_frf_pinv">
<span class="sig-name descname"><span class="pre">compute_tikhonov_regularized_frf_pinv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frfs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low_regularization_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high_regularization_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_regularization_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/forcefinder/core/auto_regularization.html#compute_tikhonov_regularized_frf_pinv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#forcefinder.core.auto_regularization.compute_tikhonov_regularized_frf_pinv" title="Link to this definition">#</a></dt>
<dd><p>Computes the Tikhonov regularized FRF pseudo-inverse for many regularization parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frfs</strong> (<em>ndarray</em>) – The array of FRFs to be inverted, should be organized
[number of lines, number of responses, number of references].</p></li>
<li><p><strong>low_regularization_limit</strong> (<em>ndarray</em>) – The low regularization limit to search through. This should be a 1d
array with a length that matches the number of frequency lines in
the SourcePathReceiver object. The default is the smallest singular
value of the frf array (on a frequency-frequency basis).</p></li>
<li><p><strong>high_regularization_limit</strong> (<em>ndarray</em>) – The high regularization limit to search through. This should be a 1d
array with a length that matches the number of frequency lines in
the SourcePathReceiver object. The default is the largest singular
value of the frf array (on a frequency-frequency basis).</p></li>
<li><p><strong>number_regularization_values</strong> (<em>int</em>) – The number of regularization parameters to search over, where the
potential parameters are geometrically spaced between the low and high
regularization limits. The default is 100.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>regularized_frf_pinv</strong> (<em>ndarray</em>) – Regularized pseudo-inverse of the FRF array. It is sized
[number of parameters, number of lines, number of responses, number of references].</p></li>
<li><p><strong>lambda_values</strong> (<em>ndarray</em>) – The regularization parameters that were used in the inverse. It is sized
[number of parameters, number of lines].</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="forcefinder.core.auto_regularization.compute_regularized_forces">
<span class="sig-name descname"><span class="pre">compute_regularized_forces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">regularized_frf_inverse</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">response</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/forcefinder/core/auto_regularization.html#compute_regularized_forces"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#forcefinder.core.auto_regularization.compute_regularized_forces" title="Link to this definition">#</a></dt>
<dd><p>Computes the forces from a regularized inverse of an FRF matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>regularized_frf_inverse</strong> (<em>ndarray</em>) – Regularized pseudo-inverse of the FRF array. Should be sized
[number of parameters, number of lines, number of references, number of responses].</p></li>
<li><p><strong>response</strong> (<em>ndarray</em>) – The response to compute the forces from. Should be sized [number of lines, number of responses]
for linear spectra or [number of lines, number of responses, number of responses] for power spectra.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>regularized_forces</strong> – The regularized forces from the supplied parameters. It is sized
[number of parameters, number of lines, number of references] for linear spectra
or [number of parameters, number of lines, number of references, number of references]
for power spectra.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="forcefinder.core.auto_regularization.l_curve_selection">
<span class="sig-name descname"><span class="pre">l_curve_selection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">regularization_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">penalty</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residual</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forces_full_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_curve_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'forces'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimality_condition</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'curvature'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">curvature_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'numerical'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/forcefinder/core/auto_regularization.html#l_curve_selection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#forcefinder.core.auto_regularization.l_curve_selection" title="Link to this definition">#</a></dt>
<dd><p>Selects the optimal regularization parameter and forces using L-curve methods</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>regularization_values</strong> (<em>ndarray</em>) – The regularization values that were searched over. This should be sized
[number of frequency lines, number of regularization values]</p></li>
<li><p><strong>penalty</strong> (<em>ndarray</em>) – The penalty from the regularized least squares problem. This should be sized
[number of frequency lines, number of regularization values]</p></li>
<li><p><strong>residual</strong> (<em>ndarray</em>) – The residual from the regularized least squares problem (typically the
mean squared error). This should be sized [number of frequency lines, number of regularization values]</p></li>
<li><p><strong>forces_full_path</strong> (<em>ndarray</em>) – The forces that were estimated in the regularized least squares problem.
It should be sized such that the number of frequency lines is on the
first axis and the number of regularization values is on the second axis.</p></li>
<li><p><strong>l_curve_type</strong> (<em>str</em>) – <p>The type of L-curve that is used to find the “optimal regularization
parameter. The available types are:</p>
<blockquote>
<div><ul>
<li><p>forces (default) - This L-curve is constructed with the “size”</p></li>
</ul>
<p>of the forces on the Y-axis and the regularization parameter on the
X-axis.
- standard - This L-curve is constructed with the residual squared
error on the X-axis and the “size” of the forces on the Y-axis.</p>
</div></blockquote>
</p></li>
<li><p><strong>optimality_condition</strong> (<em>str</em>) – <p>The method that is used to find an “optimal” regularization parameter.
The options are:</p>
<blockquote>
<div><ul>
<li><p>curvature (default) - This method searches for the regularization</p></li>
</ul>
<p>parameter that results in maximum curvature of the L-curve. It is
also referred to as the L-curve criterion.
- distance - This method searches for the regularization parameter that
minimizes the distance between the L-curve and a “virtual origin”. A
virtual origin is used, because the L-curve is scaled and offset to always
range from zero to one, in this case.</p>
</div></blockquote>
</p></li>
<li><p><strong>curvature_method</strong> (<em>str</em>) – <p>The method that is used to compute the curvature of the L-curve, in the
case that the curvature is used to find the optimal regularization
parameter. The options are:</p>
<blockquote>
<div><ul>
<li><p>numerical (default) - this method computes the curvature of</p></li>
</ul>
<p>the L-curve via numerical derivatives
- cubic_spline - this method fits a cubic spline to the L-curve
the computes the curvature from the cubic spline (this might
perform better if the L-curve isn’t “smooth”)</p>
</div></blockquote>
</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If the requested L-curve type is not available.</p></li>
<li><p><strong>ValueError</strong> – If the requested optimality condition is not available.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>chosen_force</strong> (<em>ndarray</em>) – The force at the optimal regularization value, as defined by the L-curve.
It is sized [number of frequency lines, force array size].</p></li>
<li><p><strong>optimal_regularization</strong> (<em>ndarray</em>) – A vector of the optimal regularization values, as defined by the L-curve.
The length matches that number of frequency lines.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function can handle forces as either power spectra or linear spectra.</p>
<p class="rubric">References</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id6" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>P.C. Hansen and D.P. O’Leary, “The Use of the L-Curve in the Regularization
of Discrete Ill-Posed Problems,” SIAM Journal on Scientific Computing,
vol. 14, no. 6, pp. 1487-1503, 1993.</p>
</aside>
<aside class="footnote brackets" id="id7" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<p>P.C. Hansen, “The L-curve and its use in the numerical treatment of inverse
problems,” in Computational Inverse Problems in Electrocardiology,” WIT Press,
2000, pp. 119-142.</p>
</aside>
<aside class="footnote brackets" id="id8" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></span>
<p>M. Rezghi and S. Hosseini, “A new variant of L-curve for Tikhonov regularization,”
Journal of Computational and Applied Mathematics, vol. 231, pp. 914-924, 2008.</p>
</aside>
</aside>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="forcefinder.core.auto_regularization.l_curve_criterion">
<span class="sig-name descname"><span class="pre">l_curve_criterion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regularization_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'numerical'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_curvature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/forcefinder/core/auto_regularization.html#l_curve_criterion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#forcefinder.core.auto_regularization.l_curve_criterion" title="Link to this definition">#</a></dt>
<dd><p>Finds the “optimal” regularization value from an L-curve via the
location where its curvature is at a maximum (the L-curve criterion).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_axis</strong> (<em>ndarray</em>) – This is a vector that defines the X-axis of the L-curve. The variable
that is used for this depends on the type of L-curve that is being
used.</p></li>
<li><p><strong>y_axis</strong> (<em>ndarray</em>) – This is a vector that defines the Y-axis of the L-curve. The variable
that is used for this depends on the type of L-curve that is being
used.</p></li>
<li><p><strong>regularization_values</strong> (<em>ndarray</em>) – This is a vector of regularization values that were used in the linear
regression problem that created the L-curve.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – <p>This is the method by which the curvature is computed, the
available methods are:</p>
<blockquote>
<div><ul>
<li><p>numerical (default) - this method computes the curvature of
the L-curve via numerical derivatives</p></li>
<li><p>cubic_spline - this method fits a cubic spline to the L-curve
the computes the curvature from the cubic spline (this might
perform better if the L-curve isn’t “smooth”)</p></li>
</ul>
</div></blockquote>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>optimal_regularization</strong> (<em>float</em>) – This is the optimal regularization value based on the L-curve
criterion.</p></li>
<li><p><strong>idx</strong> (<em>int</em>) – The index that correspond to the optimal curvature.</p></li>
<li><p><strong>curvature</strong> (<em>ndarray</em>) – A vector of the curvature of the L-curve for the give sequence
of regularization_values.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">References</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id9" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>P.C. Hansen and D.P. O’Leary, “The Use of the L-Curve in the Regularization
of Discrete Ill-Posed Problems,” SIAM Journal on Scientific Computing,
vol. 14, no. 6, pp. 1487-1503, 1993.</p>
</aside>
<aside class="footnote brackets" id="id10" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<p>P.C. Hansen, “The L-curve and its use in the numerical treatment of inverse
problems,” in Computational Inverse Problems in Electrocardiology,” WIT Press,
2000, pp. 119-142.</p>
</aside>
</aside>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="forcefinder.core.auto_regularization.optimal_l_curve_by_distance">
<span class="sig-name descname"><span class="pre">optimal_l_curve_by_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regularization_values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/forcefinder/core/auto_regularization.html#optimal_l_curve_by_distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#forcefinder.core.auto_regularization.optimal_l_curve_by_distance" title="Link to this definition">#</a></dt>
<dd><p>Finds the “optimal” regularization from an L-curve by finding the parameter
that puts the curve closest to the “virtual origin”.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_axis</strong> (<em>ndarray</em>) – This is a vector that defines the X-axis of the L-curve. The variable
that is used for this depends on the type of L-curve that is being
used.</p></li>
<li><p><strong>y_axis</strong> (<em>ndarray</em>) – This is a vector that defines the Y-axis of the L-curve. The variable
that is used for this depends on the type of L-curve that is being
used.</p></li>
<li><p><strong>regularization_values</strong> (<em>ndarray</em>) – This is a vector of regularization values that were used in the linear
regression problem that created the L-curve.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>optimal_regularization</strong> (<em>float</em>) – This is the optimal regularization value based on the L-curve distance
from the origin.</p></li>
<li><p><strong>idx</strong> (<em>int</em>) – The index that correspond to the optimal curvature.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This technique applies a scale and offset to the L-curve so the X and Y-axis
always ranges from zero to one. This is required to obtain predictable
behavior from the method, but can also distort the shape of the curve.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="forcefinder.core.auto_regularization.compute_residual_penalty_for_l_curve">
<span class="sig-name descname"><span class="pre">compute_residual_penalty_for_l_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frfs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forces</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">response</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/forcefinder/core/auto_regularization.html#compute_residual_penalty_for_l_curve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#forcefinder.core.auto_regularization.compute_residual_penalty_for_l_curve" title="Link to this definition">#</a></dt>
<dd><p>Computes the residual and penalty for an inverse force estimation problem
in preparation for model selection with the L-curve criterion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frfs</strong> (<em>ndarray</em>) – The FRFs that are used to compute the system response. Should be sized
[number of lines, number of responses, number of references].</p></li>
<li><p><strong>forces</strong> (<em>ndarray</em>) – The estimated forces from the inverse problem. Should be sized
[number of parameters, number of lines, number of references] for linear spectra
or [number of parameters, number of lines, number of references, number of references]
for power spectra</p></li>
<li><p><strong>response</strong> (<em>ndarray</em>) – The “truth” responses to compare the computed responses to. Should be
sized [number of lines, number of responses] for linear spectra or
[number of lines, number of responses, number of responses] for power spectra.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>residual</strong> (<em>ndarray</em>) – The residual error (i.e., sum squared error) between the computed and truth response.
It is sized [number of parameters, number of lines].</p></li>
<li><p><strong>penalty</strong> (<em>ndarray</em>) – The penalty to use in the L-curve parameter selection, which is the squared sum
of the forces. It is sized [number of parameters, number of lines].</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The returned residual and penalty are the squared norm of the residual error vector
and force vector, respectively.</p>
</dd></dl>

</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./autoapi/forcefinder/core/auto_regularization"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">forcefinder.core</p>
      </div>
    </a>
    <a class="right-next"
       href="../inverse_processing/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">forcefinder.core.inverse_processing</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#functions">Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-contents">Module Contents</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forcefinder.core.auto_regularization.tikhonov_full_path_for_l_curve"><code class="docutils literal notranslate"><span class="pre">tikhonov_full_path_for_l_curve()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forcefinder.core.auto_regularization.compute_regularized_residual_penalty_for_l_curve"><code class="docutils literal notranslate"><span class="pre">compute_regularized_residual_penalty_for_l_curve()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forcefinder.core.auto_regularization.compute_regularized_svd_inv"><code class="docutils literal notranslate"><span class="pre">compute_regularized_svd_inv()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forcefinder.core.auto_regularization.mean_squared_error"><code class="docutils literal notranslate"><span class="pre">mean_squared_error()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forcefinder.core.auto_regularization.leave_one_out_cv"><code class="docutils literal notranslate"><span class="pre">leave_one_out_cv()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forcefinder.core.auto_regularization.k_fold_cv"><code class="docutils literal notranslate"><span class="pre">k_fold_cv()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forcefinder.core.auto_regularization.l_curve_optimal_regularization"><code class="docutils literal notranslate"><span class="pre">l_curve_optimal_regularization()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forcefinder.core.auto_regularization.broadcasting_l_curve_criterion"><code class="docutils literal notranslate"><span class="pre">broadcasting_l_curve_criterion()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forcefinder.core.auto_regularization.broadcasting_l_curve_by_distance"><code class="docutils literal notranslate"><span class="pre">broadcasting_l_curve_by_distance()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forcefinder.core.auto_regularization.select_model_by_information_criterion"><code class="docutils literal notranslate"><span class="pre">select_model_by_information_criterion()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forcefinder.core.auto_regularization.compute_tikhonov_regularized_frf_pinv"><code class="docutils literal notranslate"><span class="pre">compute_tikhonov_regularized_frf_pinv()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forcefinder.core.auto_regularization.compute_regularized_forces"><code class="docutils literal notranslate"><span class="pre">compute_regularized_forces()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forcefinder.core.auto_regularization.l_curve_selection"><code class="docutils literal notranslate"><span class="pre">l_curve_selection()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forcefinder.core.auto_regularization.l_curve_criterion"><code class="docutils literal notranslate"><span class="pre">l_curve_criterion()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forcefinder.core.auto_regularization.optimal_l_curve_by_distance"><code class="docutils literal notranslate"><span class="pre">optimal_l_curve_by_distance()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forcefinder.core.auto_regularization.compute_residual_penalty_for_l_curve"><code class="docutils literal notranslate"><span class="pre">compute_residual_penalty_for_l_curve()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By National Technology & Engineering Solutions of Sandia, LLC (NTESS)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>